Разные типы недвижимости могут испытывать разнонаправленный рост на промежутке в несколько месяцев, поэтому мы построили распределение городов на карте, для того чтобы понять что скрывается за realty type. Зелёными точками на карте отмечены офисы, розовыми помещения для торговли и красными помещения свободного назначения.

Посмотрели плотность распределения таргета для разных типов разметок, видно что она смещённая для разных типов, причём для price_type = 0 много записей с аномально маленькой стоимостью, например где-то объявления по 400рублей за метр, это фейковые объявления, которые нужно отсекать.
Также смещение и из-за того, что ручная оценка чаще делается в крупных городах.

Самым историческим городом оказалась Самара, там полно зданий до 1800 года, а часть помнят ещё и Рюрика, хотя город был основан сильно позднее. Всё это выбросы.

Решение основано на бейзлайне соревнования.

Что добавили:
- фильтрация и очистка данных
- кросс-валидация по price_type=0, 1 + модели на кросс-валидации для инференса
- продолжение обучения модели на price_type=0 
- подбор гиперпараметров lgbm
- логарифм таргета и total_square из публичного решения 
- новые признаки, внешние данные из публичного решения https://github.com/OksanaGolovina/RaiffHack
- magic numbers

Что не успели:
- Валидация на сплите скользящим окном
- кастомный лосс для lgbm (grad, hess)
- три модели для разных типов 
- KNN-фишки
- модель калибрации на парах price_type=0 - price_type=1
- Эффект кладбища через ошибки на множестве запусков кросс-валидации с разным сидом

Git:
https://github.com/AlexanderGrigoriev/RaifHack_2021_7th_place